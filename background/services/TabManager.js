try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},r=(new e.Error).stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="5416e8cb-4fd6-480f-8ada-77ae804c2f40",e._sentryDebugIdIdentifier="sentry-dbid-5416e8cb-4fd6-480f-8ada-77ae804c2f40")}catch(e){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"25.11.20-edge"},(()=>{var e={1083:(e,r,s)=>{"use strict";s.d(r,{OU:()=>t});const t="Logging"},1226:(e,r,s)=>{"use strict";var t;s.d(r,{F:()=>t}),function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"}(t||(t={}))},1414:(e,r,s)=>{"use strict";s.d(r,{C:()=>g});var t=s(1083),a=s(1226);const n={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class g{constructor(e,r=a.F.WARN){this.name=e,this.level=r,this._pluggables=[]}_padding(e){return e<10?"0"+e:""+e}_ts(){const e=new Date;return[this._padding(e.getMinutes()),this._padding(e.getSeconds())].join(":")+"."+e.getMilliseconds()}configure(e){return e?(this._config=e,this._config):this._config}_log(e,...r){let s=this.level;if(g.LOG_LEVEL&&(s=g.LOG_LEVEL),"undefined"!=typeof window&&window.LOG_LEVEL&&(s=window.LOG_LEVEL),!(n[e]>=n[s]))return;let t=console.log.bind(console);e===a.F.ERROR&&console.error&&(t=console.error.bind(console)),e===a.F.WARN&&console.warn&&(t=console.warn.bind(console)),g.BIND_ALL_LOG_LEVELS&&(e===a.F.INFO&&console.info&&(t=console.info.bind(console)),e===a.F.DEBUG&&console.debug&&(t=console.debug.bind(console)));const i=`[${e}] ${this._ts()} ${this.name}`;let o="";if(1===r.length&&"string"==typeof r[0])o=`${i} - ${r[0]}`,t(o);else if(1===r.length)o=`${i} ${r[0]}`,t(i,r[0]);else if("string"==typeof r[0]){let e=r.slice(1);1===e.length&&(e=e[0]),o=`${i} - ${r[0]} ${e}`,t(`${i} - ${r[0]}`,e)}else o=`${i} ${r}`,t(i,r);for(const e of this._pluggables){const r={message:o,timestamp:Date.now()};e.pushLogs([r])}}log(...e){this._log(a.F.INFO,...e)}info(...e){this._log(a.F.INFO,...e)}warn(...e){this._log(a.F.WARN,...e)}error(...e){this._log(a.F.ERROR,...e)}debug(...e){this._log(a.F.DEBUG,...e)}verbose(...e){this._log(a.F.VERBOSE,...e)}addPluggable(e){e&&e.getCategoryName()===t.OU&&(this._pluggables.push(e),e.configure(this._config))}listPluggables(){return this._pluggables}}g.LOG_LEVEL=null,g.BIND_ALL_LOG_LEVELS=!1},3131:function(e,r){var s,t;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{const r="The message port closed before a response was received.",s=e=>{const s={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(s).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class t extends WeakMap{constructor(e,r=void 0){super(r),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const a=(r,s)=>(...t)=>{e.runtime.lastError?r.reject(new Error(e.runtime.lastError.message)):s.singleCallbackArg||t.length<=1&&!1!==s.singleCallbackArg?r.resolve(t[0]):r.resolve(t)},n=e=>1==e?"argument":"arguments",g=(e,r,s)=>new Proxy(r,{apply:(r,t,a)=>s.call(t,e,...a)});let i=Function.call.bind(Object.prototype.hasOwnProperty);const o=(e,r={},s={})=>{let t=Object.create(null),m={has:(r,s)=>s in e||s in t,get(m,l,A){if(l in t)return t[l];if(!(l in e))return;let c=e[l];if("function"==typeof c)if("function"==typeof r[l])c=g(e,e[l],r[l]);else if(i(s,l)){let r=((e,r)=>function(s,...t){if(t.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${n(r.minArgs)} for ${e}(), got ${t.length}`);if(t.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${n(r.maxArgs)} for ${e}(), got ${t.length}`);return new Promise((n,g)=>{if(r.fallbackToNoCallback)try{s[e](...t,a({resolve:n,reject:g},r))}catch(a){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,a),s[e](...t),r.fallbackToNoCallback=!1,r.noCallback=!0,n()}else r.noCallback?(s[e](...t),n()):s[e](...t,a({resolve:n,reject:g},r))})})(l,s[l]);c=g(e,e[l],r)}else c=c.bind(e);else if("object"==typeof c&&null!==c&&(i(r,l)||i(s,l)))c=o(c,r[l],s[l]);else{if(!i(s,"*"))return Object.defineProperty(t,l,{configurable:!0,enumerable:!0,get:()=>e[l],set(r){e[l]=r}}),c;c=o(c,r[l],s["*"])}return t[l]=c,c},set:(r,s,a,n)=>(s in t?t[s]=a:e[s]=a,!0),defineProperty:(e,r,s)=>Reflect.defineProperty(t,r,s),deleteProperty:(e,r)=>Reflect.deleteProperty(t,r)},l=Object.create(e);return new Proxy(l,m)},m=e=>({addListener(r,s,...t){r.addListener(e.get(s),...t)},hasListener:(r,s)=>r.hasListener(e.get(s)),removeListener(r,s){r.removeListener(e.get(s))}}),l=new t(e=>"function"!=typeof e?e:function(r){const s=o(r,{},{getContent:{minArgs:0,maxArgs:0}});e(s)}),A=new t(e=>"function"!=typeof e?e:function(r,s,t){let a,n,g=!1,i=new Promise(e=>{a=function(r){g=!0,e(r)}});try{n=e(r,s,a)}catch(e){n=Promise.reject(e)}const o=!0!==n&&((m=n)&&"object"==typeof m&&"function"==typeof m.then);var m;if(!0!==n&&!o&&!g)return!1;return(o?n:i).then(e=>{t(e)},e=>{let r;r=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",t({__mozWebExtensionPolyfillReject__:!0,message:r})}).catch(e=>{console.error("Failed to send onMessage rejected reply",e)}),!0}),c=({reject:s,resolve:t},a)=>{e.runtime.lastError?e.runtime.lastError.message===r?t():s(new Error(e.runtime.lastError.message)):a&&a.__mozWebExtensionPolyfillReject__?s(new Error(a.message)):t(a)},d=(e,r,s,...t)=>{if(t.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${n(r.minArgs)} for ${e}(), got ${t.length}`);if(t.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${n(r.maxArgs)} for ${e}(), got ${t.length}`);return new Promise((e,r)=>{const a=c.bind(null,{resolve:e,reject:r});t.push(a),s.sendMessage(...t)})},u={devtools:{network:{onRequestFinished:m(l)}},runtime:{onMessage:m(A),onMessageExternal:m(A),sendMessage:d.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:d.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},x={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return s.privacy={network:{"*":x},services:{"*":x},websites:{"*":x}},o(e,u,s)};e.exports=s(chrome)}},void 0===(t=s.apply(r,[e]))||(e.exports=t)},3391:(e,r)=>{"use strict";let s=0;r.Ay=class{constructor(e=1,r){var t;this._nextSemaphoreId=0,this._maxSemaphores=e,this.name=null!==(t=null==r?void 0:r.name)&&void 0!==t?t:"anonymous "+s++,this._loggedName=`“${this.name}”`,this._logger=null==r?void 0:r.logger,this._currentSemaphores=new Set,this._waitingCallers=[]}tryAcquire(e){var r,s;const t=this.nextSemaphoreId();if(null===(r=this._logger)||void 0===r||r.trace(`Trying acquire for semaphore ${this._loggedName} #${t}${e?` (reason: ${e})`:""} …`),this.hasAvailableSemaphores)return null===(s=this._logger)||void 0===s||s.trace(`tryAcquire() successful for semaphore ${this._loggedName} #${t}`),this._currentSemaphores.add(t),this.createReleaseFunction(t);throw new Error("No semaphore available.")}acquire(e){var r;const s=this.nextSemaphoreId();null===(r=this._logger)||void 0===r||r.trace(`Starting acquire for semaphore ${this._loggedName} #${s}${e?` (reason: ${e})`:""} …`);const t=new Promise(e=>{const r=this.createReleaseFunction(s);this._waitingCallers.push(()=>{var t;return null===(t=this._logger)||void 0===t||t.trace(`acquire() successful for semaphore ${this._loggedName} #${s}`),e(r),s})});return setTimeout(()=>this.treatPendingCallers(),0),t}release(e){var r;null===(r=this._logger)||void 0===r||r.trace(`Releasing semaphore ${this._loggedName} #${e}`),this._currentSemaphores.has(e)&&this._currentSemaphores.delete(e),setTimeout(()=>this.treatPendingCallers(),0)}nextSemaphoreId(){return this._nextSemaphoreId++}get hasAvailableSemaphores(){return this._currentSemaphores.size<this._maxSemaphores}createReleaseFunction(e){return()=>this.release(e)}treatPendingCallers(){var e,r;for(null===(e=this._logger)||void 0===e||e.trace(`Checking for free semaphore ${this._loggedName}: ${this._waitingCallers.length} waiting`);this._waitingCallers.length>0&&this.hasAvailableSemaphores;){const e=this._waitingCallers.shift();if(void 0!==e){null===(r=this._logger)||void 0===r||r.trace(`Free semaphore ${this._loggedName} found, assigning.`);const s=e();this._currentSemaphores.add(s)}}}}}},r={};function s(t){var a=r[t];if(void 0!==a)return a.exports;var n=r[t]={exports:{}};return e[t].call(n.exports,n,n.exports,s),n.exports}s.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return s.d(r,{a:r}),r},s.d=(e,r)=>{for(var t in r)s.o(r,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},s.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{"use strict";var e=s(3131),r=s.n(e),t=s(3391),a=s(1414);const n=new t.Ay(1),g=new a.C("TabManager");new class{async isPptab(e){try{const r=await this.getPerfectPostTab();return void 0!==r&&(void 0!==e.id&&r.id===e.id)}catch(e){return g.error(e),!1}}async open(e){g.info("open",{url:e});const s=await n.acquire();g.info("mutex acquired with open");const t=await this.getPerfectPostTab();if(void 0===t?.id){g.info("create new tab");const t=r().tabs.create({url:e,active:!1,pinned:!0});return await t.then(async e=>this.setPerfectPostTab(e),e=>{g.error(e)}),s(),t}g.info("reload tab");const a=await r().tabs.update(t.id,{url:e});return g.info("mutex released",{updated:a}),s(),a}async closeTab(){g.info("closeTab");const e=await n.acquire();g.info("mutex acquired with closeTab");const s=await this.getPerfectPostTab();if(void 0===s?.id)return await this.setPerfectPostTab(void 0),g.info("no tab found"),void e();const t=s.id;g.info("close PP tab"),await this.setPerfectPostTab(void 0),await r().tabs.remove(t),g.info("tab cleaned, mutex released"),e()}async getPerfectPostTab(){g.info("getPerfectPostTab");const e=await r().storage.local.get(["tabId"]),s="tabId"in e&&"number"==typeof e.tabId?e.tabId:void 0;if(g.info({tabId:s}),void 0!==s)try{const e=await r().tabs.get(s);return g.info({tab:e}),e}catch(e){return g.error({error:e}),void await r().storage.local.remove(["tabId"])}}async setPerfectPostTab(e){return g.info("setPerfectPostTab",{ptab:e}),void 0!==e?r().storage.local.set({tabId:e.id}):r().storage.local.remove(["tabId"])}}})()})();
//# sourceMappingURL=TabManager.js.map